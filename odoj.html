<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One Day One Juz</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .date-info {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-block;
            margin-top: 10px;
        }

        .nav-tabs {
            display: flex;
            gap: 5px;
            margin: 30px 30px 0 30px;
            background: rgba(255, 255, 255, 0.1);
            padding: 5px;
            border-radius: 15px;
        }

        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            background: transparent;
            border: none;
            border-radius: 10px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-tab.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .participants-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .participant-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 5px solid #4CAF50;
        }

        .participant-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .participant-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .participant-name {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }

        .juz-number {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 8px 15px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.1em;
        }

        .progress-section {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .custom-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #4CAF50;
            border-radius: 6px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .custom-checkbox.checked {
            background: #4CAF50;
        }

        .custom-checkbox.checked::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 16px;
        }

        .submit-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            opacity: 0.6;
            pointer-events: none;
        }

        .submit-btn.enabled {
            opacity: 1;
            pointer-events: auto;
        }

        .submit-btn:hover.enabled {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .timestamp {
            font-size: 0.9em;
            color: #666;
            font-style: italic;
            margin-top: 10px;
            padding: 8px;
            background: #f0f8f0;
            border-radius: 8px;
            border-left: 3px solid #4CAF50;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            transition: width 0.3s ease;
        }

        .monthly-recap {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .month-selector {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .month-nav {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .month-nav:hover {
            background: #45a049;
            transform: scale(1.1);
        }

        .current-month {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
            min-width: 200px;
            text-align: center;
        }

        .participants-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .participants-table th,
        .participants-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .participants-table th {
            background: #4CAF50;
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
        }

        .participants-table tr:hover {
            background: #f9f9f9;
        }

        .consistency-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .consistency-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #ffa500, #4CAF50);
            transition: width 0.3s ease;
        }

        .consistency-text {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .streak-badge {
            background: #4CAF50;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .streak-badge.low {
            background: #ff6b6b;
        }

        .streak-badge.medium {
            background: #ffa500;
        }

        .streak-badge.high {
            background: #4CAF50;
        }

        @media (max-width: 768px) {
            .participants-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .participant-card {
                padding: 15px;
            }

            .participants-table {
                font-size: 0.9em;
            }

            .nav-tab {
                padding: 10px 15px;
                font-size: 0.9em;
            }

            .nav-tabs {
                margin: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🕌 One Day One Juz</h1>
            <div class="date-info">
                <strong id="currentDate"></strong>
            </div>
            
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="switchTab('daily')">📅 Harian</button>
                <button class="nav-tab" onclick="switchTab('monthly')">📊 Rekap Bulanan</button>
            </div>
        </div>

        <div class="content">
            <!-- Tab Harian -->
            <div class="tab-content active" id="daily-tab">
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="completedToday">0</div>
                        <div class="stat-label">Selesai Hari Ini</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalProgress">0%</div>
                        <div class="stat-label">Progress Hari Ini</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="dayCount">1</div>
                        <div class="stat-label">Hari Ke-</div>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>

                <div class="participants-grid" id="participantsGrid">
                    <!-- Participants akan di-generate oleh JavaScript -->
                </div>
            </div>

            <!-- Tab Rekap Bulanan -->
            <div class="tab-content" id="monthly-tab">
                <div class="monthly-recap">
                    <div class="month-selector">
                        <button class="month-nav" onclick="changeMonth(-1)">←</button>
                        <div class="current-month" id="currentMonthDisplay"></div>
                        <button class="month-nav" onclick="changeMonth(1)">→</button>
                    </div>

                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-number" id="monthlyCompletionRate">0%</div>
                            <div class="stat-label">Tingkat Penyelesaian</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="mostConsistent">-</div>
                            <div class="stat-label">Paling Konsisten</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="averageStreak">0</div>
                            <div class="stat-label">Rata-rata Streak</div>
                        </div>
                    </div>

                    <h3 style="margin: 30px 0 20px 0; color: #333;">📊 Tabel Konsistensi Peserta</h3>
                    <table class="participants-table">
                        <thead>
                            <tr>
                                <th>Nama</th>
                                <th>Hari Selesai</th>
                                <th>Konsistensi</th>
                                <th>Streak Terpanjang</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="consistencyTableBody">
                            <!-- Data akan di-generate oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data peserta
        const participants = [
            'Ahmad Fauzi', 'Siti Nurhaliza', 'Muhammad Rizky', 'Fatimah Zahra', 'Abdul Rahman',
            'Khadijah Amalia', 'Umar Farouk', 'Aisyah Putri', 'Ali Hakim', 'Maryam Salsabila',
            'Yusuf Ibrahim', 'Zainab Fitri', 'Hamzah Amir', 'Ruqayyah Dewi', 'Bilal Hakim',
            'Safiyyah Nora', 'Khalid Bayu', 'Hafsa Cantika', 'Saad Abdullah', 'Ummu Kultsum',
            'Tariq Ramadan', 'Asma Maharani', 'Zubair Malik', 'Hafsah Indira', 'Salman Alfarisi',
            'Nusaybah Putri', 'Mu\'adh bin Jabal', 'Sumayyah Rani', 'Abdullah Azzam', 'Khansa Aulia'
        ];

        // Tanggal mulai program (bisa disesuaikan)
        const startDate = new Date('2025-01-01');
        
        // Storage key untuk data progress
        const STORAGE_KEY = 'oneDayOneJuzProgress';

        // Load progress dari memory
        let progressData = {};
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();

        // Tab management
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');

            if (tabName === 'monthly') {
                renderMonthlyRecap();
            }
        }

        // Monthly recap functions
        function changeMonth(direction) {
            currentMonth += direction;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderMonthlyRecap();
        }

        function getDaysInMonth(month, year) {
            return new Date(year, month + 1, 0).getDate();
        }

        function getMonthName(month) {
            const months = [
                'Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
                'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'
            ];
            return months[month];
        }

        function calculateConsistency(participantIndex, month, year) {
            const daysInMonth = getDaysInMonth(month, year);
            let completedDays = 0;
            let longestStreak = 0;
            let currentStreak = 0;

            for (let day = 1; day <= daysInMonth; day++) {
                const dateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayData = progressData[dateString];
                
                if (dayData && dayData[participantIndex] && dayData[participantIndex].completed) {
                    completedDays++;
                    currentStreak++;
                    longestStreak = Math.max(longestStreak, currentStreak);
                } else {
                    currentStreak = 0;
                }
            }

            const percentage = Math.round((completedDays / daysInMonth) * 100);
            return {
                completedDays,
                totalDays: daysInMonth,
                percentage,
                longestStreak
            };
        }

        function renderMonthlyRecap() {
            // Update month display
            document.getElementById('currentMonthDisplay').textContent = 
                `${getMonthName(currentMonth)} ${currentYear}`;

            // Calculate overall statistics
            let totalCompletions = 0;
            let totalPossible = 0;
            let allStreaks = [];
            let consistencyData = [];

            participants.forEach((name, index) => {
                const consistency = calculateConsistency(index, currentMonth, currentYear);
                consistencyData.push({
                    name,
                    index,
                    ...consistency
                });
                totalCompletions += consistency.completedDays;
                totalPossible += consistency.totalDays;
                allStreaks.push(consistency.longestStreak);
            });

            // Update monthly stats
            const overallRate = totalPossible > 0 ? Math.round((totalCompletions / totalPossible) * 100) : 0;
            document.getElementById('monthlyCompletionRate').textContent = overallRate + '%';

            // Find most consistent participant
            if (consistencyData.length > 0) {
                const mostConsistent = consistencyData.reduce((prev, current) => 
                    (prev.percentage > current.percentage) ? prev : current
                );
                document.getElementById('mostConsistent').textContent = mostConsistent.name;
            }

            // Calculate average streak
            const averageStreak = allStreaks.length > 0 ? Math.round(allStreaks.reduce((a, b) => a + b, 0) / allStreaks.length) : 0;
            document.getElementById('averageStreak').textContent = averageStreak;

            // Render consistency table
            renderConsistencyTable(consistencyData);
        }

        function renderConsistencyTable(consistencyData) {
            const tbody = document.getElementById('consistencyTableBody');
            tbody.innerHTML = '';

            if (consistencyData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #666;">Belum ada data untuk bulan ini</td></tr>';
                return;
            }

            // Sort by consistency percentage
            consistencyData.sort((a, b) => b.percentage - a.percentage);

            consistencyData.forEach((data, rank) => {
                const row = document.createElement('tr');
                
                // Determine status badge
                let statusClass = 'low';
                let statusText = 'Perlu Perbaikan';
                if (data.percentage >= 80) {
                    statusClass = 'high';
                    statusText = 'Sangat Baik';
                } else if (data.percentage >= 60) {
                    statusClass = 'medium';
                    statusText = 'Baik';
                }

                row.innerHTML = `
                    <td><strong>${data.name}</strong></td>
                    <td>${data.completedDays}/${data.totalDays} hari</td>
                    <td>
                        <div class="consistency-bar">
                            <div class="consistency-fill" style="width: ${data.percentage}%"></div>
                            <div class="consistency-text">${data.percentage}%</div>
                        </div>
                    </td>
                    <td>${data.longestStreak} hari</td>
                    <td><span class="streak-badge ${statusClass}">${statusText}</span></td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Generate sample data untuk demo
        function generateSampleData() {
            const today = new Date();
            const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
            const endOfMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0);

            // Generate data untuk bulan ini
            for (let d = new Date(startOfMonth); d <= endOfMonth; d.setDate(d.getDate() + 1)) {
                const dateString = d.toISOString().split('T')[0];
                if (d <= today) { // Hanya generate data untuk hari yang sudah lewat
                    progressData[dateString] = {};
                    
                    participants.forEach((name, index) => {
                        // Simulasi konsistensi yang berbeda-beda
                        const consistency = 0.5 + (Math.sin(index) * 0.3) + (Math.random() * 0.2);
                        const completed = Math.random() < consistency;
                        
                        if (completed) {
                            progressData[dateString][index] = {
                                completed: true,
                                timestamp: new Date(d.getTime() + Math.random() * 24 * 60 * 60 * 1000).toISOString()
                            };
                        }
                    });
                }
            }
        }

        function getCurrentDateString() {
            const today = new Date();
            return today.toISOString().split('T')[0];
        }

        function getDayNumber() {
            const today = new Date();
            const diffTime = Math.abs(today - startDate);
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            return diffDays + 1;
        }

        function getJuzForParticipant(participantIndex, dayNumber) {
            // Rotasi juz berdasarkan hari
            return ((participantIndex + dayNumber - 1) % 30) + 1;
        }

        function formatDateTime(date) {
            return date.toLocaleString('id-ID', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
        }

        function saveProgress() {
            // Dalam implementasi real, ini akan menyimpan ke server
            // Untuk demo, kita simpan di memory
        }

        function loadProgress() {
            // Dalam implementasi real, ini akan load dari server
            return progressData;
        }

        function updateStats() {
            const today = getCurrentDateString();
            const completed = Object.values(progressData[today] || {}).filter(p => p.completed).length;
            const percentage = Math.round((completed / participants.length) * 100);
            
            document.getElementById('completedToday').textContent = completed;
            document.getElementById('totalProgress').textContent = percentage + '%';
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('dayCount').textContent = getDayNumber();
        }

        function toggleCheckbox(participantIndex) {
            const today = getCurrentDateString();
            if (!progressData[today]) {
                progressData[today] = {};
            }
            
            const currentData = progressData[today][participantIndex] || { completed: false };
            const checkbox = document.getElementById(`checkbox-${participantIndex}`);
            const submitBtn = document.getElementById(`submit-${participantIndex}`);
            const timestampDiv = document.getElementById(`timestamp-${participantIndex}`);
            
            if (!currentData.completed) {
                // Enable submit button when checkbox is checked
                checkbox.classList.add('checked');
                submitBtn.classList.add('enabled');
            } else {
                // If already submitted, don't allow unchecking
                return;
            }
        }

        function submitProgress(participantIndex) {
            const today = getCurrentDateString();
            if (!progressData[today]) {
                progressData[today] = {};
            }
            
            const now = new Date();
            progressData[today][participantIndex] = {
                completed: true,
                timestamp: now.toISOString()
            };
            
            const submitBtn = document.getElementById(`submit-${participantIndex}`);
            const timestampDiv = document.getElementById(`timestamp-${participantIndex}`);
            
            // Disable submit button and show timestamp
            submitBtn.style.display = 'none';
            timestampDiv.innerHTML = `✅ Diselesaikan pada: ${formatDateTime(now)}`;
            timestampDiv.style.display = 'block';
            
            saveProgress();
            updateStats();
        }

        function renderParticipants() {
            const grid = document.getElementById('participantsGrid');
            const today = getCurrentDateString();
            const dayNumber = getDayNumber();
            const todayProgress = progressData[today] || {};
            
            grid.innerHTML = '';
            
            participants.forEach((name, index) => {
                const juzNumber = getJuzForParticipant(index, dayNumber);
                const participantProgress = todayProgress[index] || { completed: false };
                
                const card = document.createElement('div');
                card.className = 'participant-card';
                
                card.innerHTML = `
                    <div class="participant-info">
                        <div class="participant-name">${name}</div>
                        <div class="juz-number">Juz ${juzNumber}</div>
                    </div>
                    <div class="progress-section">
                        <div class="checkbox-container">
                            <div class="custom-checkbox ${participantProgress.completed ? 'checked' : ''}" 
                                 id="checkbox-${index}" 
                                 onclick="toggleCheckbox(${index})"></div>
                            <span>Selesai membaca</span>
                        </div>
                        <button class="submit-btn ${participantProgress.completed ? '' : ''}" 
                                id="submit-${index}" 
                                onclick="submitProgress(${index})"
                                style="display: ${participantProgress.completed ? 'none' : 'inline-block'}">
                            Submit
                        </button>
                    </div>
                    <div class="timestamp" 
                         id="timestamp-${index}" 
                         style="display: ${participantProgress.completed ? 'block' : 'none'}">
                        ${participantProgress.completed ? 
                          `✅ Diselesaikan pada: ${formatDateTime(new Date(participantProgress.timestamp))}` : ''}
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        function updateCurrentDate() {
            const today = new Date();
            document.getElementById('currentDate').textContent = 
                today.toLocaleDateString('id-ID', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
        }

        // Initialize app
        function init() {
            updateCurrentDate();
            generateSampleData(); // Generate sample data untuk demo
            progressData = loadProgress();
            renderParticipants();
            updateStats();
        }

        // Auto refresh setiap menit untuk update waktu
        setInterval(() => {
            updateCurrentDate();
        }, 60000);

        // Initialize when page loads
        init();
    </script>
</body>
</html>